{"version":3,"sources":["../src/block-crowdfunding-details.js"],"names":["wp","data","registerBlockType","blocks","RichText","blockEditor","element","Component","Fragment","RawHTML","DescriptionList","props","children","DescriptionDetails","style","formatMoney","value","parseFloat","fractionDigits","toFixed","replace","title","pronamic_crowdfunding_details","icon","category","parent","attributes","currencySymbol","type","default","list","term","term_raised","amount","color","term_target","term_contributions","edit","setAttributes","className","updateCurrencySymbol","updateDescriptionTerm","index","updateDescriptionDetail","content","item","hasOwnProperty","descriptions","map","labelStyle","valueStyle","label","save"],"mappings":"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","sourcesContent":["/* globals pronamic_crowdfunding_details */\nconst { data } = wp;\nconst { registerBlockType } = wp.blocks;\nconst { RichText } = wp.blockEditor;\nconst { Component, Fragment, RawHTML } = wp.element;\n\n( function () {\n\t'use strict';\n\n\tclass DescriptionList extends Component {\n\t\trender() {\n\t\t\treturn <dl className=\"ppcf-dl-list\">{ this.props.children }</dl>\n\t\t}\n\t}\n\n\tclass DescriptionDetails extends Component {\n\t\trender() {\n\t\t\treturn <dd className=\"ppcf-dl-list__value\" style={ this.props.style }>{ this.props.children }</dd>\n\t\t}\n\t}\n\n\tconst formatMoney = ( value ) => {\n\t\tvalue = parseFloat( value );\n\n\t\t// Fraction digits.\n\t\tlet fractionDigits = 2;\n\n\t\tif ( 0 === ( value * 100 ) % 100 ) {\n\t\t\tfractionDigits = 0;\n\t\t}\n\n\t\treturn value.toFixed( fractionDigits ).replace( /\\./g, ',' );\n\t};\n\n\t/**\n\t * Register details block type.\n\t *\n\t * @param string name     Block name.\n\t * @param object settings Block settings.\n\t *\n\t * @return WPBlock        Block if registered successfully, otherwise \"undefined\".\n\t */\n\tregisterBlockType( 'pronamic-pay/crowdfunding-details', {\n\t\ttitle: pronamic_crowdfunding_details.title,\n\t\ticon: 'info',\n\t\tcategory: 'pronamic-pay',\n\t\tparent: [ 'pronamic-pay/crowdfunding-donut', 'pronamic-pay/crowdfunding-bar', 'pronamic-pay/crowdfunding-compact', 'core/column', 'core/group' ],\n\n\t\t// Attributes.\n\t\tattributes: {\n\t\t\tcurrencySymbol: {\n\t\t\t\ttype: 'string',\n\t\t\t\tdefault: 'â‚¬'\n\t\t\t},\n\t\t\tlist: {\n\t\t\t\ttype: 'array',\n\t\t\t\tdefault: [\n\t\t\t\t\t{\n\t\t\t\t\t\tterm: pronamic_crowdfunding_details.term_raised,\n\t\t\t\t\t\tamount: '0,00',\n\t\t\t\t\t\tcolor: null\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tterm: pronamic_crowdfunding_details.term_target,\n\t\t\t\t\t\tamount: '0,00',\n\t\t\t\t\t\tcolor: null\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tterm: pronamic_crowdfunding_details.term_contributions,\n\t\t\t\t\t\tvalue: '0',\n\t\t\t\t\t\tcolor: null\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t},\n\n\t\t// Edit.\n\t\tedit: ( { attributes, setAttributes, className } ) => {\n\t\t\tlet { color, currencySymbol, list } = attributes;\n\n\t\t\tconst updateCurrencySymbol = ( currencySymbol ) => {\n\t\t\t\tsetAttributes( { currencySymbol: currencySymbol } );\n\t\t\t};\n\n\t\t\tconst updateDescriptionTerm = ( index, term ) => {\n\t\t\t\tlist[ index ].term = term;\n\n\t\t\t\tsetAttributes( { list: list } );\n\t\t\t};\n\n\t\t\tconst updateDescriptionDetail = ( index, content ) => {\n\t\t\t\titem = list[ index ];\n\n\t\t\t\tif ( item.hasOwnProperty( 'amount' ) ) {\n\t\t\t\t\titem.amount = content;\n\t\t\t\t} else {\n\t\t\t\t\titem.value = content;\n\t\t\t\t}\n\n\t\t\t\tlist[ index ] = item;\n\n\t\t\t\tsetAttributes( { list: list } );\n\t\t\t};\n\n\t\t\tlet descriptions = list.map( ( item, index ) => {\n\t\t\t\tlet labelStyle = {};\n\t\t\t\tlet valueStyle = {};\n\n\t\t\t\tif ( item.color ) {\n\t\t\t\t\tif ( item.color.hasOwnProperty( 'label' ) ) {\n\t\t\t\t\t\tlabelStyle = { color: item.color.label };\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( item.color.hasOwnProperty( 'value' ) ) {\n\t\t\t\t\t\tvalueStyle = { color: item.color.value };\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn (\n\t\t\t\t\t<Fragment key={ index }>\n\t\t\t\t\t\t<RichText\n\t\t\t\t\t\t\ttagName=\"dt\"\n\t\t\t\t\t\t\tclassName=\"ppcf-dl-list__label\"\n\t\t\t\t\t\t\tvalue={ item.term }\n\t\t\t\t\t\t\tonChange={ ( content ) => updateDescriptionTerm( index, content ) }\n\t\t\t\t\t\t\tstyle={ labelStyle }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<DescriptionDetails onChange={ ( content ) => updateDescriptionDetail( index, content ) } style={ valueStyle }>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titem.hasOwnProperty( 'amount' ) ?\n\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t<RichText\n\t\t\t\t\t\t\t\t\t\t\ttagName=\"span\"\n\t\t\t\t\t\t\t\t\t\t\tvalue={ currencySymbol }\n\t\t\t\t\t\t\t\t\t\t\tonChange={ ( content ) => setAttributes( { currencySymbol: content } ) }\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t{ ' ' + formatMoney( item.amount ) }\n\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\t\titem.value\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</DescriptionDetails>\n\t\t\t\t\t</Fragment>\n\t\t\t\t)\n\t\t\t} );\n\n\t\t\treturn (\n\t\t\t\t<DescriptionList className={ className }>\n\t\t\t\t\t{ descriptions }\n\t\t\t\t</DescriptionList>\n\t\t\t);\n\t\t},\n\n\t\t// Save.\n\t\tsave: ( { attributes } ) => {\n\t\t\tlet { currencySymbol, list } = attributes;\n\n\t\t\tlet descriptions = list.map( ( item, index ) => {\n\t\t\t\tlet labelStyle = {};\n\t\t\t\tlet valueStyle = {};\n\n\t\t\t\tif ( item.color ) {\n\t\t\t\t\tif ( item.color.hasOwnProperty( 'label' ) ) {\n\t\t\t\t\t\tlabelStyle = { color: item.color.label };\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( item.color.hasOwnProperty( 'value' ) ) {\n\t\t\t\t\t\tvalueStyle = { color: item.color.value };\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn (\n\t\t\t\t\t<Fragment key={ index }>\n\t\t\t\t\t\t<dt className=\"ppcf-dl-list__label\" style={ labelStyle }>\n\t\t\t\t\t\t\t<RawHTML>\n\t\t\t\t\t\t\t\t{ item.term }\n\t\t\t\t\t\t\t</RawHTML>\n\t\t\t\t\t\t</dt>\n\t\t\t\t\t\t<dd className=\"ppcf-dl-list__value\" style={ valueStyle }>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titem.hasOwnProperty( 'amount' ) ?\n\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t{ currencySymbol + ' ' + formatMoney( item.amount ) }\n\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\t\titem.value\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</dd>\n\t\t\t\t\t</Fragment>\n\t\t\t\t);\n\t\t\t} );\n\n\t\t\treturn (\n\t\t\t\t<dl className=\"ppcf-dl-list\">\n\t\t\t\t\t{ descriptions }\n\t\t\t\t</dl>\n\t\t\t);\n\t\t}\n\t} );\n} )();\n"],"file":"block-crowdfunding-details.js"}