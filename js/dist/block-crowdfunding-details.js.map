{"version":3,"sources":["../src/block-crowdfunding-details.js"],"names":["wp","data","registerBlockType","blocks","RichText","blockEditor","element","Component","Fragment","RawHTML","DescriptionList","props","children","DescriptionDetails","formatMoney","value","parseFloat","fractionDigits","toFixed","replace","title","icon","category","parent","attributes","currencySymbol","type","default","list","term","amount","edit","setAttributes","className","updateCurrencySymbol","updateDescriptionTerm","index","updateDescriptionDetail","content","item","hasOwnProperty","definitions","map","save"],"mappings":"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","sourcesContent":["const { data } = wp;\nconst { registerBlockType } = wp.blocks;\nconst { RichText } = wp.blockEditor;\nconst { Component, Fragment, RawHTML } = wp.element;\n\n( function () {\n\t'use strict';\n\n\tclass DescriptionList extends Component {\n\t\trender() {\n\t\t\treturn <dl className=\"ppd-dl-list\">{ this.props.children }</dl>\n\t\t}\n\t}\n\n\tclass DescriptionDetails extends Component {\n\t\trender() {\n\t\t\treturn <dd className=\"ppd-dl-list__value\">{ this.props.children }</dd>\n\t\t}\n\t}\n\n\tconst formatMoney = ( value ) => {\n\t\tvalue = parseFloat( value );\n\n\t\t// Fraction digits.\n\t\tlet fractionDigits = 2;\n\n\t\tif ( 0 === value % 100 ) {\n\t\t\tfractionDigits = 0;\n\t\t}\n\n\t\treturn value.toFixed( fractionDigits ).replace( /\\./g, ',' );\n\t};\n\n\t/**\n\t * Register details block type.\n\t *\n\t * @param string name     Block name.\n\t * @param object settings Block settings.\n\t *\n\t * @return WPBlock        Block if registered successfully, otherwise \"undefined\".\n\t */\n\tregisterBlockType( 'pronamic-pay/crowdfunding-details', {\n\t\ttitle: 'Details',\n\t\ticon: 'info',\n\t\tcategory: 'pronamic-pay',\n\t\tparent: [ 'pronamic-pay/crowdfunding-ring', 'core/column' ],\n\n\t\t// Attributes.\n\t\tattributes: {\n\t\t\tcurrencySymbol: {\n\t\t\t\ttype: 'string',\n\t\t\t\tdefault: 'â‚¬'\n\t\t\t},\n\t\t\tlist: {\n\t\t\t\ttype: 'array',\n\t\t\t\tdefault: [\n\t\t\t\t\t{\n\t\t\t\t\t\tterm: 'Raised',\n\t\t\t\t\t\tamount: '0,00'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tterm: 'Target',\n\t\t\t\t\t\tamount: '0,00'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tterm: 'Number of contributions',\n\t\t\t\t\t\tvalue: '0'\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t},\n\n\t\t// Edit.\n\t\tedit: ( { attributes, setAttributes, className } ) => {\n\t\t\tlet { list, currencySymbol } = attributes;\n\n\t\t\tconst updateCurrencySymbol = ( currencySymbol ) => {\n\t\t\t\tsetAttributes( { currencySymbol: currencySymbol } );\n\t\t\t};\n\n\t\t\tconst updateDescriptionTerm = ( index, term ) => {\n\t\t\t\tlist[ index ].term = term;\n\n\t\t\t\tsetAttributes( { list: list } );\n\t\t\t};\n\n\t\t\tconst updateDescriptionDetail = ( index, content ) => {\n\t\t\t\titem = list[ index ];\n\n\t\t\t\tif ( item.hasOwnProperty( 'amount' ) ) {\n\t\t\t\t\titem.amount = content;\n\t\t\t\t} else {\n\t\t\t\t\titem.value = content;\n\t\t\t\t}\n\n\t\t\t\tlist[ index ] = item;\n\n\t\t\t\tsetAttributes( { list: list } );\n\t\t\t};\n\n\t\t\tlet definitions = list.map( ( item, index ) => {\n\t\t\t\treturn (\n\t\t\t\t\t<Fragment key={ index }>\n\t\t\t\t\t\t<RichText\n\t\t\t\t\t\t\ttagName=\"dt\"\n\t\t\t\t\t\t\tclassName=\"ppd-dl-list__label\"\n\t\t\t\t\t\t\tvalue={ item.term }\n\t\t\t\t\t\t\tonChange={ ( content ) => updateDescriptionTerm( index, content ) }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<DescriptionDetails onChange={ ( content ) => updateDescriptionDetail( index, content ) }>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titem.hasOwnProperty( 'amount' ) ?\n\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t<RichText\n\t\t\t\t\t\t\t\t\t\t\ttagName=\"span\"\n\t\t\t\t\t\t\t\t\t\t\tvalue={ currencySymbol }\n\t\t\t\t\t\t\t\t\t\t\tonChange={ ( content ) => setAttributes( { currencySymbol: content } ) }\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t{ ' ' + formatMoney( item.amount ) }\n\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\t\titem.value\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</DescriptionDetails>\n\t\t\t\t\t</Fragment>\n\t\t\t\t)\n\t\t\t} );\n\n\t\t\treturn (\n\t\t\t\t<DescriptionList className={ className }>\n\t\t\t\t\t{ definitions }\n\t\t\t\t</DescriptionList>\n\t\t\t);\n\t\t},\n\n\t\t// Save.\n\t\tsave: ( { attributes } ) => {\n\t\t\tlet { currencySymbol, list } = attributes;\n\n\t\t\tlet definitions = list.map( ( item, index ) => {\n\t\t\t\treturn (\n\t\t\t\t\t<Fragment key={ index }>\n\t\t\t\t\t\t<dt className=\"ppd-dl-list__label\">\n\t\t\t\t\t\t\t<RawHTML>\n\t\t\t\t\t\t\t\t{ item.term }\n\t\t\t\t\t\t\t</RawHTML>\n\t\t\t\t\t\t</dt>\n\t\t\t\t\t\t<dd className=\"ppd-dl-list__value\">\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titem.hasOwnProperty( 'amount' ) ?\n\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t{ currencySymbol + ' ' + formatMoney( item.amount ) }\n\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\t\titem.value\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</dd>\n\t\t\t\t\t</Fragment>\n\t\t\t\t);\n\t\t\t} );\n\n\t\t\treturn (\n\t\t\t\t<dl className=\"ppd-dl-list\">\n\t\t\t\t\t{ definitions }\n\t\t\t\t</dl>\n\t\t\t);\n\t\t}\n\t} );\n} )();\n"],"file":"block-crowdfunding-details.js"}